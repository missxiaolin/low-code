const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["static/js/layer-CQjlKlTc.js","static/js/index-Ui9nu09D.js","static/css/index-D_IH-oG1.css","static/css/layer-Bo_cQZpI.css","static/js/grid-BHb0u_gh.js","static/css/grid-B57TZmu8.css","static/js/index-COBvjRxj.js","static/js/dom-xiVlsJSO.js","static/css/index-CyCOOJJ3.css","static/js/editScale-O2oLW7Oo.js","static/css/editScale-BGWFNuB0.css","static/js/index-CtFGfVwC.js","static/js/code-generator-factory-VUDefhT5.js","static/js/index.browser-CcxBvUBP.js","static/css/index-YQ1rOcM3.css","static/js/index-D-CSvviE.js","static/js/index-DKZ-GboX.js","static/css/index-DkpSJT6C.css","static/js/index-COkRaUZX.js","static/css/index-CMlDz50I.css","static/js/code-CYUsm6EK.js","static/js/xml-fold-91UrTSGh.js","static/css/xml-fold-D05cK1KH.css","static/js/parser-html-BZw5MWIk.js","static/css/code-P2i0O_fr.css"])))=>i.map(i=>d[i]);
var R=(P,b,C)=>new Promise((D,L)=>{var V=y=>{try{O(C.next(y))}catch(w){L(w)}},I=y=>{try{O(C.throw(y))}catch(w){L(w)}},O=y=>y.done?D(y.value):Promise.resolve(y.value).then(V,I);O((C=C.apply(P,b)).next())});import{ag as W,a0 as ie,d as p,_ as G,a as E,j as h,k as oe,p as se,r as f,o as J,f as F,b as g,w as ae,s as le,e as S,D as ce,J as de,H as ue,I as he,c as $,X as _e,G as me,ah as ve,ai as pe,__tla as Ee}from"./index-Ui9nu09D.js";import{p as ye,E as fe,c as Ce,d as be,g as we}from"./code-generator-factory-VUDefhT5.js";import{c as ge}from"./index.browser-CcxBvUBP.js";let q,U,H,Se=Promise.all([(()=>{try{return Ee}catch(P){}})()]).then(()=>R(void 0,null,function*(){function P(n){if(n){const e=n.attributes.lc_id.nodeValue;let r=window.templateSourceMap[e];return!r&&window.tree&&(r=window.tree[e]),r}return null}function b(n){return Object.prototype.toString.apply(n)==="[object Object]"}function C(n){return Object.keys(n)[0]}function D(n){return n[C(n)]}function L(n){const e=function(r){return D(r).lc_id}(n);return!!window.templateSourceMap[e]}function V(n){return n.attributes&&n.attributes.lc_id?n:n.parentNode?V(n.parentNode):null}H=function(n){return n.querySelector(".title")&&(n=n.querySelector(".title")),n.attributes.lc_id?P(n):{[n.localName]:{__text__:n.innerText,class:n.className}}},q=function(){return"@#$!"};function I(n){window.tree||(window.tree={}),function(e){(function r(t){for(const i in t)if(t.hasOwnProperty(i)){const o=t[i];if(t.hasOwnProperty("__key__")&&t.__key__==="__children"&&b(o)&&delete t.__key__,i==="lc_id"&&t.hasOwnProperty("__key__")){const s=t.__key__,d={[s]:t};d.__proto__=t.__proto__,delete t.__key__,window.tree[o]=d}else i==="__children"?t.__children.forEach(s=>{s.__key__=i,r(s)}):b(o)&&(o.__key__=i,r(o))}})(e)}(n)}function O(n){return P(V(n))}class y{constructor(e){this.rawVueInfo={},this.isOnload=!1,this.editMode=!0,this.eventEmitter=new fe,this.currentPointPositionAfterIndex=-1,this.renderStack=[],this.redoStack=[],this.externalJS={},this.customCss="",this.eventNode={},this.customData={},this.componentOptions={},this.dropIninFunction=e&&e.dropIninFunction?e.dropIninFunction:""}subscribeEventListener(e,r){this.eventEmitter.on(e,r)}getComponentOptions(){return this.componentOptions}onSelectElement(e){return this.subscribeEventListener("selected",e),this}onRootElementMounted(e){return this.subscribeEventListener("mounted",e),this}onCodeCreated(e){return this.subscribeEventListener("codeCreated",e),this}onCodeStructureUpdated(e){return this.subscribeEventListener("codeStructureUpdated",e),this}onMerged(e){return this.subscribeEventListener("onMerged",e),this}onNodeDeleted(e){return this.subscribeEventListener("onNodeDeleted",e),this}setDropInfo(e){this.currentPointDropInfo=e}saveCssCodeOnly(e){return this.customCss=e||"",this}saveJSCodeOnly(e){return this.externalJS=e||"",this}saveEventNode(e){return this.eventNode=e,this}saveJsData(e){return this.customData=e,this}setEditMode(e,r){this.editMode=e,this.mountedEle=r,this.reRender()}reRender(){return this._render(this._rawDataStructure),this}asyncReRender(){return R(this,null,function*(){return yield this._render(this._rawDataStructure),this})}render(e){return this._render(e),this}_render(e){return R(this,null,function*(){this._rawDataStructure=e;const r=W(e);this.eventEmitter.emit("codeStructureUpdated",r),this.initCodeGenerator();let t=yield this.codeGenerator.outputVueCodeWithJsonObj(e);t=t.replace(/:\s*\(([\w\s,]*)\)\s*=>/g,"($1)");let i=t.replace(/\s{1}lc_id=".+?"/g,"");return i=i.replace(/\s{1}vccName=".+?"/g,""),i=i.replace(/\s{1}component_name=".+?"/g,""),i=i.replace(/\s{1}lc-mark/g,""),i=i.replace(/\s{1}div-lc-mark/g,""),this.eventEmitter.emit("codeCreated",i),this.enableEditMode(),this.flatDataStructure(e),this})}enableEditMode(){const e=this.getControlPanelRoot();this.enableDelayTask&&clearTimeout(this.enableDelayTask),this.enableDelayTask=setTimeout(()=>{this.eventEmitter.emit("mounted",e),this.initComonentsEvent()},500)}initComonentsEvent(){this.getControlPanelRoot(),this.isOnload||(this.initDropEvent(),this.isOnload=!0)}markElement(e){if(this.currentEditElement&&this.currentEditElement.classList.remove("mark-element"),this.getControlPanelRoot().querySelectorAll("[lc_id]").forEach(r=>{r.classList.remove("mark-element")}),e){this.currentEditElement=e;const r=this.markElementInner(e);this.rawVueInfo=r;const t=W(r);this.eventEmitter.emit("selected",t)}else this.eventEmitter.emit("selected",null)}markElementInner(e){e.classList.add("mark-element");const r=O(e);let t=C(r);return r[Object.keys(r)[0]].vccName&&(t=r[Object.keys(r)[0]].vccName),e.setAttribute("lc-component-name",t),r}clearElementSelect(){this.markElement(null)}initDropEvent(){const e=this.getControlPanelRoot();e.addEventListener("dragenter",r=>{r.preventDefault()}),e.addEventListener("dragleave",r=>{r.preventDefault()}),e.addEventListener("dragover",r=>{r.preventDefault()}),e.addEventListener("drop",r=>{let t=r.dataTransfer.getData("text/plain").split("@#$!");const i=t[2],o={"mic-shape":{vccComponentName:t[3],vccName:i,":defaultStyle":`{'top':20,'left':20,'width':${Number(t[4])},'height':${Number(t[5])}}`,lc_id:"micShape",__children:[]}};L(o)&&this.initDropCode(o),this.updateCodeStructure(o)})}initDropCode(e){(function(r){const t=C(r),i=r[t],o=ye[t];if(o){for(const s in o)if(o.hasOwnProperty(s)){const d=o[s];i[s]=d}}})(e),function(r,t){let i=t;(function o(s){if(b(s)){for(const v in s)if(s.hasOwnProperty(v)){const l=s[v];if(v=="lc_id"){const _=s[v],k=ge("1234567890abcdefghijklmnopqrstuvwxyz",10)();i=i.replace(_,k),s[v]=k}else b(l)?o(l):(d=l,Object.prototype.toString.apply(d)==="[object Array]"&&l.forEach(_=>o(_)))}}var d})(r)}(e,""),I(e)}updateCodeStructure(e){const r=this.getControlPanelRoot().childNodes[0];r&&(function(t,i,o=-1,s=()=>{}){t&&i&&(t.__children||(t.__children=[]),o>-1?t.__children.splice(o,0,i):t.__children.push(i),s(),i.__proto__={parentCodeNode:t})}(D(O(r)),e,-1,()=>{this.eventEmitter.emit("onMerged")}),this.render(this._rawDataStructure))}flatDataStructure(e){I(e)}initCodeGenerator(){this.codeGenerator=Ce(),this.codeGenerator.setExternalJS(this.externalJS),this.codeGenerator.setExternalCss(this.customCss),this.codeGenerator.setEventNode(this.eventNode),this.codeGenerator.setCustomData(this.customData)}createMountedElement(){const e=this.getControlPanelRoot();return this.styleNodeName&&e.setAttribute("class",this.styleNodeName),e}getControlPanelRoot(){return document.getElementById("render-control-panel")}appLoad(e,r){const t={"/main.vue":be(e,this._rawDataStructure),"/events.json":`${JSON.stringify(this.eventNode)}`},i=we(t),o=ie(p(()=>window["vue3-sfc-loader"].loadModule("/main.vue",i)));window.loadApp(o),o.mount(r)}setKeyValue(e,r,t){if(!e||!r)return;const i=D(window.tree[t]);return i[e]=r,this.render(this._rawDataStructure),i.lc_id&&setTimeout(()=>{this.selectElement(i.lc_id)},10),this}saveAttribute(e,r,t=!0){const i=e,o=D(window.tree[r]);for(const s in o)o.hasOwnProperty(s)&&s!="__children"&&s!="lc-mark"&&s!="lc_id"&&s!="div-lc-mark"&&s!="vccName"&&!b(o[s])&&delete o[s];return i.forEach(s=>{o[s.key]=s.value}),this.render(this._rawDataStructure),o.lc_id&&t&&setTimeout(()=>{this.selectElement(o.lc_id,o.vccName)},10),this}selectElement(e){const r=this.getControlPanelRoot().querySelector(`[lc_id="${e}"]`);r&&setTimeout(()=>{r.click()})}getRawDataStructure(){return this._rawDataStructure}getRawVueInfo(){return this.rawVueInfo}}const w={components:{Layer:p(()=>E(()=>import("./layer-CQjlKlTc.js"),__vite__mapDeps([0,1,2,3]))),Grid:p(()=>E(()=>import("./grid-BHb0u_gh.js"),__vite__mapDeps([4,1,2,5]))),ruler:p(()=>E(()=>import("./index-COBvjRxj.js"),__vite__mapDeps([6,1,2,7,8]))),editScale:p(()=>E(()=>import("./editScale-O2oLW7Oo.js"),__vite__mapDeps([9,1,2,10]))),micShape:p(()=>E(()=>import("./index-Ui9nu09D.js").then(n=>R(void 0,null,function*(){return yield n.__tla,n})).then(n=>n.aL),__vite__mapDeps([1,2]))),rawComponents:p(()=>E(()=>import("./index-CtFGfVwC.js"),__vite__mapDeps([11,1,2,12,13,14]))),attributeInput:p(()=>E(()=>import("./index-D-CSvviE.js").then(n=>R(void 0,null,function*(){return yield n.__tla,n})),__vite__mapDeps([15,1,2,16,17]))),toolsBar:p(()=>E(()=>import("./index-COkRaUZX.js"),__vite__mapDeps([18,1,2,19]))),lcCode:p(()=>E(()=>import("./code-CYUsm6EK.js"),__vite__mapDeps([20,1,2,21,22,23,24])))},props:{initCodeEntity:{type:Object,default:()=>({})},asyncComponents:{type:Array,default:()=>[]}},setup(n,{emit:e}){const r=h(!1);let t=h(!1);h({});let i=h({});const o=h(""),s=h(null),d=h(null),v=h(.5);window.vccScale=v.value;const l=h({width:0,height:0,hWidth:0}),_=new y,k=h(""),T=h(""),A=h([]),N=h(null),te=h(null),ne=(m,a=!1)=>{let u={};return A.value=m||[],m.forEach(c=>{["string","array","object"].includes(c.key)||c.key==="string"?u[c.key]=c.value:c.key==="number"?u[c.key]=Number(c.value):c.key==="boolean"?u[c.key]=c.value==="true"||c.value===!0:u[c.key]=c.value}),a&&(_.saveJsData(u),this.renderCode()),u},re=()=>{var m;_.onRootElementMounted(a=>{document.getElementsByTagName("body")[0].addEventListener("click",De=>{_.clearElementSelect()});const u=document.documentElement.clientWidth,c=Math.max(a.offsetWidth,u);d.value&&(l.value.scale=v.value,l.hWidth=c,l.value.height=a.offsetHeight+150,l.value.width=c,d.value.setHRule(c+250,l.value),d.value.setVRule(l.value))}).onMerged(()=>{}).onCodeCreated(a=>{o.value=a}).onCodeStructureUpdated(a=>{i.value=a.template.__children[0].div,a.value=JSON.parse(JSON.stringify(a))}).onNodeDeleted(()=>{s.value=null}).onSelectElement(a=>{s.value=a}).saveCssCodeOnly((m=n.initCodeEntity.css?n.initCodeEntity.css:"",k.value=m,m)).saveJSCodeOnly((a=>{try{let u=a;return T.value=a,u}catch(u){}})(n.initCodeEntity.JSCode?n.initCodeEntity.JSCode:"")).saveEventNode(n.initCodeEntity.eventNode).saveJsData(ne(n.initCodeEntity.customData||[])).render(n.initCodeEntity.codeStructure?n.initCodeEntity.codeStructure:{template:{lc_id:"root",__children:[{div:{class:"container",lc_id:"container",style:"min-height: 100%;"}}]}}),window.vccMainPanelProvider=_};return oe(()=>{Promise.all([E(()=>import("./load-DwytJNh1.js"),[])]).then(m=>{re(),N.value=n.initCodeEntity.eventNode})}),se("mainPanelProvider",_),{showCodeDialogVisible:()=>{t.value=!0},codeDialogVisible:t,editorRef:te,ruleRef:d,canvas:l,scale:v,handleScaleChange:m=>{window.vccScale=m,l.value.scale=m,v.value=m,d.value.setHRule(l.hWidth,l.value),d.value.setVRule(l.value);const a=s.value;_.asyncReRender(),a&&Object.keys(a).length>0&&setTimeout(()=>{_.selectElement(a[Object.keys(a)[0]].lc_id)},10)},dCode:o,comJson:i,getAttr:m=>{const a=JSON.parse(JSON.stringify(m["mic-shape"]));return Object.keys(a).forEach(u=>{u.startsWith(":")&&(a[u.substring(1)]=ve(a[u]))}),a},isFullWidth:r}}},j=()=>{pe(n=>({"60c3f1b8":n.scale}))},M=w.setup;w.setup=M?(n,e)=>(j(),M(n,e)):j;const B={class:"editor-box vcc-main"},z={class:"vcc-main-content"},K={class:"base-component-container"},X={class:"vcc-main-container"},Q={id:"editor",class:"editor",ref:"editorRef"},Y={class:"preview-container"},Z={id:"render-control-panel"},ee=["id","lc_id"];let x;x=G({name:"vcc-editor-d",components:{vccEditor:G(w,[["render",function(n,e,r,t,i,o){const s=f("tools-bar"),d=f("layer"),v=f("raw-components"),l=f("ruler"),_=f("mic-shape"),k=f("edit-scale"),T=f("attribute-input"),A=f("lcCode");return J(),F("div",B,[g(s,{class:"vcc-tools-bar",onShowCodeDialogVisible:t.showCodeDialogVisible,onOnShowLayer:e[0]||(e[0]=N=>t.isFullWidth=!t.isFullWidth)},{default:ae(()=>[le(n.$slots,"toole",{},void 0,!0)]),_:3},8,["onShowCodeDialogVisible"]),S("div",z,[g(d,{isFullWidth:t.isFullWidth},null,8,["isFullWidth"]),S("nav",K,[g(v)]),S("div",X,[S("div",Q,[g(l,{ref:"ruleRef"},null,512),S("div",Y,[S("div",Z,[S("div",{class:ce(t.comJson.class),id:t.comJson.id,lc_id:t.comJson.lc_id,style:de(t.comJson.style)},[t.comJson.__children&&t.comJson.__children.length>0?(J(!0),F(ue,{key:0},he(t.comJson.__children,N=>(J(),$(_,_e({ref_for:!0},t.getAttr(N),{scale:t.scale}),null,16,["scale"]))),256)):me("",!0)],14,ee)])])],512),g(k,{scale:t.scale,onChange:t.handleScaleChange},null,8,["scale","onChange"])]),g(T)]),g(A,{codeDialogVisible:t.codeDialogVisible,"onUpdate:codeDialogVisible":e[1]||(e[1]=N=>t.codeDialogVisible=N),rawCode:t.dCode},null,8,["codeDialogVisible","rawCode"])])}],["__scopeId","data-v-6ad1c3c7"]])},setup:()=>({codeInfoEntity:{codeStructure:JSON.parse('{"template":{"lc_id":"root","__children":[{"div":{"class":"container","id": "vcc-container","style": "width: 1920px; height: 1080px;background-color: #142A41;position: relative;","lc_id":"container","__children":[]}}]}}'),JSCode:`export default {
    setup() {
  
      return {};
    },
  };
  `,mode:1,css:"",eventNode:{},customData:[]}})},[["render",function(n,e,r,t,i,o){const s=f("vccEditor");return J(),$(s,{asyncComponents:[],initCodeEntity:t.codeInfoEntity},null,8,["initCodeEntity"])}]]),U=Object.freeze(Object.defineProperty({__proto__:null,default:x},Symbol.toStringTag,{value:"Module"}))}));export{Se as __tla,q as a,U as d,H as g};
