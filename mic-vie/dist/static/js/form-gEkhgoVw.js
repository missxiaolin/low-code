const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["static/js/vcc-BAF6nNqa.js","static/js/index-CR_1l9OE.js","static/css/index-ZapVBUj5.css","static/js/vueCodeEditorDialog-D_PB8yMz.js","static/css/vcc-DGjGRO8R.css"])))=>i.map(i=>d[i]);
import{_export_sfc as e,ref as t,resolveComponent as o,openBlock as a,createElementBlock as s,createVNode as r,withCtx as n,createTextVNode as i,defineAsyncComponent as u,api as c,createCommentVNode as d,__vitePreload as p,__tla as __tla_0}from"./index-CR_1l9OE.js";import{pageRouteDetail as l,pageRouteSave as m}from"./page-DbwzypxG.js";let v;let __tla=Promise.all([(()=>{try{return __tla_0}catch{}})()]).then(async()=>{function h(e,t){return""===t||/^\//.test(t)?Promise.resolve():Promise.reject("路由路径必须/开头")}const f=e({props:["pageForm"],emits:["success"],setup(e,{emit:o}){let a=t(!1);const s=t(!1),r=t([{label:"禁用",value:1,disabled:!0},{label:"启用",value:2}]);let n=t({form:{route_name:e.pageForm.route_name||"",path:e.pageForm.path||"",status:e.pageForm.status||2},rules:{route_name:[{required:!0,message:"请输入路由名称"}],path:[{required:!0,message:"请输入路由路径"},{validator:h,trigger:"change"}],status:[{required:!0,message:"Please select status"}]}});return{props:e,open:a,showPagePop:()=>{a.value=!0},formRef:s,statusOptions:r,pageData:n,onSubmit:()=>{s.value.validate().then((()=>{o("success",n.value.form),a.value=!1})).catch((e=>{}))},resetForm:()=>{s.value.resetFields()}}}},[["render",function(e,t,u,c,d,p){const l=o("BookOutlined"),m=o("a-button"),h=o("a-input"),f=o("a-form-item"),g=o("a-radio-group"),_=o("a-form"),v=o("a-modal");return a(),s("li",null,[r(m,{type:"link",onClick:c.showPagePop},{default:n((()=>[r(l),t[4]||(t[4]=i("页面设置 "))])),_:1},8,["onClick"]),r(v,{open:c.open,"onUpdate:open":t[3]||(t[3]=e=>c.open=e),title:"页面设置",footer:null},{default:n((()=>[r(_,{ref:"formRef","label-col":{span:3},model:c.pageData.form,rules:c.pageData.rules},{default:n((()=>[r(f,{ref:"route_name",label:"路由名称",name:"route_name"},{default:n((()=>[r(h,{value:c.pageData.form.route_name,"onUpdate:value":t[0]||(t[0]=e=>c.pageData.form.route_name=e)},null,8,["value"])])),_:1},512),r(f,{ref:"path",label:"路由路径",name:"path"},{default:n((()=>[r(h,{value:c.pageData.form.path,"onUpdate:value":t[1]||(t[1]=e=>c.pageData.form.path=e),disabled:c.props.pageForm.id>0},null,8,["value","disabled"])])),_:1},512),r(f,{ref:"status",label:"路由路径",name:"status"},{default:n((()=>[r(g,{value:c.pageData.form.status,"onUpdate:value":t[2]||(t[2]=e=>c.pageData.form.status=e),options:c.statusOptions},null,8,["value","options"])])),_:1},512),r(f,{class:"form-bottom-btns"},{default:n((()=>[r(m,{type:"primary",onClick:c.onSubmit},{default:n((()=>t[5]||(t[5]=[i("保存")]))),_:1},8,["onClick"]),r(m,{style:{"margin-left":"10px"},onClick:c.resetForm},{default:n((()=>t[6]||(t[6]=[i("重置")]))),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["open"])])}],["__scopeId","data-v-f1485c6c"]]),g={components:{vcc:u((()=>p((()=>import("./vcc-BAF6nNqa.js").then(async m=>{await m.__tla;return m}).then((e=>e.vcc))),__vite__mapDeps([0,1,2,3,4])))),toolePage:f},data:()=>({projectId:0,pageForm:{id:0,route_name:"",path:"",status:2},isShowVcc:!1,codeInfoEntity:{codeStructure:"",JSCode:"",mode:1,css:"",eventNode:{},customData:[]}}),mounted(){this.projectId=Number(this.$route.query.projectId)||0,this.pageForm.id=Number(this.$route.query.pageId)||0,this.init()},methods:{async init(){if(!this.pageForm.id||0===this.pageForm.id)return this.codeInfoEntity.JSCode="export default {\n  setup() {\n\n    return {};\n  },\n};\n",this.codeInfoEntity.css="",this.codeInfoEntity.codeStructure=JSON.parse('{"template":{"lc_id":"root","lc_uuid":"root","__children":[{"div":{"class":"container","style": "min-height: 100%;","lc_id":"container","lc_uuid":"container","__children":[]}}]}}'),void(this.isShowVcc=!0);let e=await l({id:this.pageForm.id,projectId:this.projectId});if(!e.success)return void c.error(e.errorMessage);const t=e.model;this.pageForm={id:t.id,route_name:t.route_name,path:t.path,status:t.status},this.codeInfoEntity.JSCode=t.script_json,this.codeInfoEntity.css=t.css,this.codeInfoEntity.codeStructure=JSON.parse(t.tem_json),this.codeInfoEntity.eventNode=JSON.parse(t.eventNode),this.codeInfoEntity.customData=JSON.parse(t.customData),this.isShowVcc=!0},onCodeUpdate({codeRawVueInfo:e,JSCode:t,css:o,eventNode:a,customData:s}){},onLoadFinish(){},async save(e){if(!this.pageForm.route_name||!this.pageForm.path)return c.error("请先设置页面信息！！！");const t={id:this.pageForm.id,project_id:this.$route.query.projectId,route_name:this.pageForm.route_name,path:this.pageForm.path,status:this.pageForm.status,tem_json:JSON.stringify(e.codeRawVueInfo),script_json:e.JSCode,page_html:e.code,css:e.css,eventNode:JSON.stringify(e.eventNode),customData:JSON.stringify(e.customData)};let o=await m(t);o.success?(c.success("保存成功"),setTimeout((()=>{this.$router.push({path:"/project/page",query:{projectId:this.$route.query.projectId}})}),2e3)):c.error(o.errorMessage)},toolePageSuccess(e){this.pageForm={route_name:e.route_name,path:e.path,status:e.status}}}},_={key:0,class:"vcc-detaiil-box"};v=e(g,[["render",function(e,t,i,u,c,p){const l=o("toolePage"),m=o("vcc");return c.isShowVcc?(a(),s("div",_,[r(m,{initCodeEntity:c.codeInfoEntity,onUpdateCodeEntity:p.onCodeUpdate,onOnLoadFinish:p.onLoadFinish,onSave:p.save},{toole:n((()=>[r(l,{pageForm:c.pageForm,onSuccess:p.toolePageSuccess},null,8,["pageForm","onSuccess"])])),_:1},8,["initCodeEntity","onUpdateCodeEntity","onOnLoadFinish","onSave"])])):d("",!0)}],["__scopeId","data-v-2e2af3a5"]])});export{v as default,__tla};