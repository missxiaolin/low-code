var h=(g,t,c)=>new Promise((e,i)=>{var p=l=>{try{u(c.next(l))}catch(n){i(n)}},s=l=>{try{u(c.throw(l))}catch(n){i(n)}},u=l=>l.done?e(l.value):Promise.resolve(l.value).then(p,s);u((c=c.apply(g,t)).next())});import{c as O,a as U,b as q}from"./component-C-vL7I6j.js";import{c as z}from"./index-CN0uO3Re.js";import{_ as I,a5 as S,j as F,k as E,r,o as C,f as L,e as b,b as a,w as m,W as d,F as _,c as P,G as H}from"./index-COMSe1sn.js";const R=[{key:"id",title:"ID",align:"center"},{key:"name",title:"\u540D\u79F0",align:"center"},{key:"create_time",title:"\u521B\u5EFA\u65F6\u95F4",align:"center"},{key:"update_time",title:"\u4FEE\u6539\u65F6\u95F4",align:"center"},{key:"options",prop:"options",align:"center",title:"\u64CD\u4F5C",width:"250px",fixed:"right",noEmptyValue:!0}],D={class:"home-main"},G={class:"mu-search-container pall10"},M={class:"mu-search-form-button"},V={class:"mu-handle-content flex flex-1 flex-column"},W={class:"mb20"},A=I({components:{codeEditor:z},setup(g){const t=S(),c=F(!1),e=F(null),i=t.currentProjectId,p=F({id:0,project_id:Number(i),name:"",componentName:"",component:"",attribute:"{}",version:""}),s=F({name:"",pageSize:10,projectId:Number(i),page:1});let u=F({data:[],columns:R,total:0});const l=()=>h(this,null,function*(){let n=yield O(s.value);n.success&&(u.value.data=n.model.list||[],u.value.total=n.model.count)});return E(()=>{l()}),{searchForm:s,resetSearchForm:()=>{s.value={name:"",pageSize:10,page:1},l()},table:u,showPop:()=>{p.value={id:0,project_id:Number(i),name:"",componentName:"",component:"",attribute:'{"component":[],"style":["width","height"],"customComponent":{"base":{"title":"\u57FA\u7840","children":[]},"event":{"title":"\u4E8B\u4EF6","children":[]}}}',version:""},c.value=!0},edit:n=>h(this,null,function*(){p.value={id:n.id,project_id:n.project_id,name:n.name,componentName:n.componentName,component:n.component,attribute:n.attribute,version:""},c.value=!0}),getComponentList:l,handleCurrentChange:n=>{s.value.page=n+1,getMenuList()},componentFormOpen:c,componentFormRef:e,componentFormForm:p,saveComponent:()=>{e.value.validate().then(()=>h(this,null,function*(){(yield U(p.value)).success&&(c.value=!1,l())})).catch(n=>{})},generate:n=>h(this,null,function*(){(yield q({projectId:i,id:n.id})).success&&l()})}}},[["render",function(g,t,c,e,i,p){const s=r("a-input"),u=r("mic-search-label"),l=r("a-col"),n=r("a-row"),v=r("a-button"),k=r("mic-search-table"),f=r("a-form-item"),y=r("a-textarea"),w=r("codeEditor"),N=r("a-form"),j=r("a-modal");return C(),L("div",D,[b("div",G,[a(n,null,{default:m(()=>[a(l,{span:8},{default:m(()=>[a(u,{labelName:"\u540D\u79F0"},{default:m(()=>[a(s,{value:e.searchForm.name,"onUpdate:value":t[0]||(t[0]=o=>e.searchForm.name=o),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["value"])]),_:1})]),_:1}),a(l,{span:8}),a(l,{span:8})]),_:1}),b("div",M,[a(v,{onClick:e.resetSearchForm},{default:m(()=>t[6]||(t[6]=[d("\u91CD\u7F6E")])),_:1},8,["onClick"]),a(v,{type:"primary",onClick:e.getComponentList},{default:m(()=>t[7]||(t[7]=[d("\u67E5\u8BE2")])),_:1},8,["onClick"])])]),b("div",V,[b("div",W,[a(v,{type:"primary",onClick:e.showPop},{default:m(()=>t[8]||(t[8]=[d("\u6DFB\u52A0")])),_:1},8,["onClick"])]),a(k,{data:e.table.data,columns:e.table.columns,total:e.table.total,onHandleCurrentChange:e.handleCurrentChange},{type:m(o=>[d(_(o.row.type==1?"\u83DC\u5355":"\u6309\u94AE"),1)]),status:m(o=>[d(_(o.row.status==1?"\u663E\u793A":"\u9690\u85CF"),1)]),options:m(o=>[a(v,{link:"",size:"small",onClick:x=>e.edit(o.row)},{default:m(()=>t[9]||(t[9]=[d(" \u7F16\u8F91 ")])),_:2},1032,["onClick"]),a(v,{link:"",size:"small",onClick:x=>e.generate(o.row),class:"ml10"},{default:m(()=>t[10]||(t[10]=[d(" \u53D1\u5E03 ")])),_:2},1032,["onClick"])]),_:1},8,["data","columns","total","onHandleCurrentChange"])]),e.componentFormOpen?(C(),P(j,{key:0,open:e.componentFormOpen,"onUpdate:open":t[5]||(t[5]=o=>e.componentFormOpen=o),onOk:e.saveComponent,title:"\u7EC4\u4EF6"},{default:m(()=>[a(N,{model:e.componentFormForm,"label-col":{span:4},ref:"componentFormRef"},{default:m(()=>[a(f,{label:"\u540D\u79F0",name:"name",rules:[{required:!0,message:"\u540D\u79F0\u5FC5\u586B!"}]},{default:m(()=>[a(s,{value:e.componentFormForm.name,"onUpdate:value":t[1]||(t[1]=o=>e.componentFormForm.name=o)},null,8,["value"])]),_:1}),a(f,{label:"\u7EC4\u4EF6name",name:"componentName",rules:[{required:!0,message:"\u7EC4\u4EF6\u540D\u79F0\u5FC5\u586B!"}]},{default:m(()=>[a(s,{value:e.componentFormForm.componentName,"onUpdate:value":t[2]||(t[2]=o=>e.componentFormForm.componentName=o)},null,8,["value"])]),_:1}),a(f,{label:"\u7EC4\u4EF6\u5185\u5BB9",name:"component",rules:[{required:!0,message:"\u7EC4\u4EF6\u5185\u5BB9\u5FC5\u586B!"}]},{default:m(()=>[a(y,{value:e.componentFormForm.component,"onUpdate:value":t[3]||(t[3]=o=>e.componentFormForm.component=o)},null,8,["value"])]),_:1}),a(f,{label:"\u7EC4\u4EF6\u5C5E\u6027",name:"attribute",rules:[{required:!0,message:"\u7EC4\u4EF6\u5C5E\u6027\u5FC5\u586B!"}]},{default:m(()=>[a(w,{style:{height:"200px"},language:"json",value:e.componentFormForm.attribute,"onUpdate:value":t[4]||(t[4]=o=>e.componentFormForm.attribute=o)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","onOk"])):H("",!0)])}]]);export{A as default};
