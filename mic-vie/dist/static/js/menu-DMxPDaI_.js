import{request as e,_export_sfc as a,useGeneralStore as t,ref as l,reactive as o,onMounted as u,api as r,resolveComponent as n,openBlock as s,createElementBlock as m,createBaseVNode as i,createVNode as p,withCtx as d,createTextVNode as c,toDisplayString as f,createBlock as v,Fragment as y,renderList as h,createCommentVNode as _}from"./index-CR_1l9OE.js";const F=[{key:"id",title:"ID",align:"center"},{key:"name",title:"名称",align:"center"},{key:"path",title:"路径",align:"center"},{key:"type",prop:"type",title:"类型",align:"center"},{key:"status",prop:"status",title:"状态",align:"center"},{key:"create_time",title:"创建时间",align:"center"},{key:"update_time",title:"修改时间",align:"center"},{key:"options",prop:"options",align:"center",title:"操作",width:"250px",fixed:"right",noEmptyValue:!0}];const b={class:"home-main"},g={class:"mu-search-container pall10"},k={class:"mu-search-form-button"},C={class:"mu-handle-content flex flex-1 flex-column"},w={class:"mb20"};const j=a({setup(){const a=t().currentProjectId,n=l(null);let s=l([]),m=l(!1),i=l({projectId:Number(a),name:"",type:"",status:"",pageSize:10,page:1});const p=o([{value:1,label:"显示"},{value:2,label:"隐藏"}]),d=o([{value:1,label:"菜单"},{value:2,label:"页面"}]);let c=l({data:[],columns:F,total:0}),f=l({ruleForm:{id:0,project_id:Number(a),menu_id:"",path:"",name:"",type:1,status:1},rules:[]});const v=async()=>{let a=await(t={...i.value},e({url:"/adm/project/menu/list",method:"post",data:t}));var t;a.success&&(c.value.data=a.model.list,c.value.total=a.model.count)},y=async()=>{let t=await(l={projectId:a},e({url:"/adm/project/menu/all",method:"post",data:l}));var l;t.success&&(s.value=t.model)};return u((()=>{a?(y(),v()):r.info("请先选择项目！")})),{edit:e=>{f.value.ruleForm={id:e.id,menu_id:0===e.menu_id?"":e.menu_id,path:e.path,name:e.name,type:e.type,status:e.status},m.value=!0},menuListOptions:s,typeOptions:d,statusOptions:p,searchForm:i,getMenuList:v,resetSearchForm:()=>{i.value={name:"",type:"",status:"",pageSize:10,page:1},v()},table:c,handleCurrentChange:e=>{i.value.page=e+1,v()},open:m,showPop:()=>{f.value.ruleForm={id:0,projectId:Number(a),menu_id:"",path:"",name:"",type:1,status:1},m.value=!0},form:f,formRef:n,onSubmit:()=>{n.value.validate().then((async()=>{var t;(await(t={...f.value.ruleForm,project_id:Number(a),menu_id:""===f.value.ruleForm.menu_id?0:f.value.ruleForm.menu_id},e({url:"/adm/project/menu/save",method:"post",data:t}))).success&&(m.value=!1,v())})).catch((e=>{}))},resetForm:()=>{n.value.resetFields()}}}},[["render",function(e,a,t,l,o,u){const r=n("a-input"),F=n("mic-search-label"),j=n("a-col"),x=n("a-select"),U=n("a-row"),O=n("a-button"),N=n("mic-search-table"),S=n("a-radio-group"),I=n("a-form-item"),L=n("a-select-option"),z=n("a-form"),P=n("a-modal");return s(),m("div",b,[i("div",g,[p(U,null,{default:d((()=>[p(j,{span:8},{default:d((()=>[p(F,{labelName:"名称"},{default:d((()=>[p(r,{value:l.searchForm.name,"onUpdate:value":a[0]||(a[0]=e=>l.searchForm.name=e),placeholder:"请输入名称"},null,8,["value"])])),_:1})])),_:1}),p(j,{span:8},{default:d((()=>[p(F,{labelName:"分类"},{default:d((()=>[p(x,{value:l.searchForm.type,"onUpdate:value":a[1]||(a[1]=e=>l.searchForm.type=e),options:l.typeOptions,placeholder:"请选择分类"},null,8,["value","options"])])),_:1})])),_:1}),p(j,{span:8},{default:d((()=>[p(F,{labelName:"状态"},{default:d((()=>[p(x,{value:l.searchForm.status,"onUpdate:value":a[2]||(a[2]=e=>l.searchForm.status=e),placeholder:"请选择分类",options:l.statusOptions},null,8,["value","options"])])),_:1})])),_:1})])),_:1}),i("div",k,[p(O,{onClick:l.resetSearchForm},{default:d((()=>a[9]||(a[9]=[c("重置")]))),_:1},8,["onClick"]),p(O,{type:"primary",onClick:l.getMenuList},{default:d((()=>a[10]||(a[10]=[c("查询")]))),_:1},8,["onClick"])])]),i("div",C,[i("div",w,[p(O,{type:"primary",onClick:l.showPop},{default:d((()=>a[11]||(a[11]=[c("添加")]))),_:1},8,["onClick"])]),p(N,{data:l.table.data,columns:l.table.columns,total:l.table.total,onHandleCurrentChange:l.handleCurrentChange},{type:d((e=>[c(f(1==e.row.type?"菜单":"按钮"),1)])),status:d((e=>[c(f(1==e.row.status?"显示":"隐藏"),1)])),options:d((e=>[p(O,{link:"",size:"small",onClick:a=>l.edit(e.row)},{default:d((()=>a[12]||(a[12]=[c(" 编辑 ")]))),_:2},1032,["onClick"])])),_:1},8,["data","columns","total","onHandleCurrentChange"])]),p(P,{title:"创建",footer:null,open:l.open,"onUpdate:open":a[8]||(a[8]=e=>l.open=e)},{default:d((()=>[p(z,{ref:"formRef",model:l.form.ruleForm,rules:l.form.rules,"label-col":{span:3}},{default:d((()=>[p(I,{ref:"type",label:"类型",name:"type"},{default:d((()=>[p(S,{options:l.typeOptions,value:l.form.ruleForm.type,"onUpdate:value":a[3]||(a[3]=e=>l.form.ruleForm.type=e)},null,8,["options","value"])])),_:1},512),2==l.form.ruleForm.type?(s(),v(I,{key:0,ref:"menu_id",label:"菜单",name:"menu_id"},{default:d((()=>[p(x,{value:l.form.ruleForm.menu_id,"onUpdate:value":a[4]||(a[4]=e=>l.form.ruleForm.menu_id=e),allowClear:""},{default:d((()=>[(s(!0),m(y,null,h(l.menuListOptions,(e=>(s(),v(L,{key:e.id,value:e.id},{default:d((()=>[c(f(e.name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1},512)):_("",!0),p(I,{ref:"name",label:"名称",name:"name",rules:[{required:!0,message:"请输入名称!"}]},{default:d((()=>[p(r,{value:l.form.ruleForm.name,"onUpdate:value":a[5]||(a[5]=e=>l.form.ruleForm.name=e)},null,8,["value"])])),_:1},512),2==l.form.ruleForm.type?(s(),v(I,{key:1,ref:"path",label:"路径",name:"path",rules:[{required:!0,message:"请输入路径!"}]},{default:d((()=>[p(r,{value:l.form.ruleForm.path,"onUpdate:value":a[6]||(a[6]=e=>l.form.ruleForm.path=e)},null,8,["value"])])),_:1},512)):_("",!0),p(I,{ref:"status",label:"状态",name:"status"},{default:d((()=>[p(S,{options:l.statusOptions,value:l.form.ruleForm.status,"onUpdate:value":a[7]||(a[7]=e=>l.form.ruleForm.status=e)},null,8,["options","value"])])),_:1},512),p(I,{class:"form-bottom-box"},{default:d((()=>[p(O,{type:"primary",onClick:l.onSubmit},{default:d((()=>a[13]||(a[13]=[c("保存")]))),_:1},8,["onClick"]),p(O,{style:{"margin-left":"10px"},onClick:l.resetForm},{default:d((()=>a[14]||(a[14]=[c("重置")]))),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["open"])])}]]);export{j as default};
